import{createComponent as e,Dynamic as t,spread as r,mergeProps as n,insert as o,template as s,use as i,effect as l}from"solid-js/web";import{mergeProps as c,createEffect as a,createMemo as u,onCleanup as f,createRoot as d,createSignal as h,onMount as g,createComputed as _,on as p}from"solid-js";const v=null,m=Math.min,w=Math.max,b=Math.abs,S=setTimeout,y=(e,t,r)=>m(r,w(t,e)),z="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},x=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},k=-1,I=(e,t,r)=>{const n=r?"unshift":"push";for(let r=0;r<t;r++)e[n](k);return e},M=(e,t)=>{const r=e.o[t];return r===k?e.i:r},T=(e,t,r)=>{const n=e.o[t]===k;return e.o[t]=r,e.l=m(t,e.l),n},R=(e,t)=>{if(!e.u)return 0;if(e.l>=t)return e.h[t];e.l<0&&(e.h[0]=0,e.l=0);let r=e.l,n=e.h[r];for(;r<t;)n+=M(e,r),e.h[++r]=n;return e.l=t,n},C=(e,t,r)=>{for(;r>=0&&r<e.u;){const n=R(e,r);if(n<=t){if(n+M(e,r)>t)break;r++}else r--}return y(r,0,e.u-1)},J=(e,t,r)=>{const n=t-e.u;return e.l=r?-1:m(t-1,e.l),e.u=t,n>0?(I(e.h,n),I(e.o,n,r),e.i*n):(e.h.splice(n),(r?e.o.splice(0,-n):e.o.splice(n)).reduce(((t,r)=>t-(r===k?e.i:r)),0))},O="undefined"!=typeof window,P=()=>document.documentElement,B=e=>e.ownerDocument,D=e=>e.defaultView,E=/*#__PURE__*/x((()=>!!O&&"rtl"===getComputedStyle(P()).direction)),H=/*#__PURE__*/x((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),L=/*#__PURE__*/x((()=>"scrollBehavior"in P().style)),W=(e,t,r,n,o)=>(1!==n&&(e-=w(0,r)),2!==n&&(t+=w(0,r)),[w(e,0),m(t,o-1)]),j=(e,t=40,r=0,n,o=!1)=>{let s=!!r,i=[],l=0,c=0,a=0,u=0,f=0,d=0,h=0,g=0,_=0,p=s?[0,w(r-1,0)]:v,S=[0,0],y=0;const z=((e,t)=>({i:t,o:I([],e),u:e,l:-1,h:I([],e)}))(e,t),x=new Set,O=()=>a-c,P=e=>((e,t,r,n)=>{const o=C(e,t,m(r,e.u-1));return[o,C(e,t+n,o)]})(z,e,S[0],l),B=()=>(e=>e.u?R(e,e.u-1)+M(e,e.u-1):0)(z),D=e=>R(z,e)-d,E=e=>M(z,e),L=e=>{e&&(H()&&0!==g?d+=e:(f+=e,u++))};return{_:()=>i,p:()=>(e=>[[...e.o],e.i])(z),v:()=>h?S:(S=P(w(0,O()+d+f)),p?[m(S[0],p[0]),w(S[1],p[1])]:S),m:e=>z.o[e]===k,S:()=>!!l,k:()=>!!p&&z.o.slice(w(0,p[0]-1),m(z.u-1,p[1]+1)+1).includes(k),I:D,M:E,T:()=>z.u,R:()=>a,C:()=>g,J:()=>l,O:()=>c,P:B,B:()=>u,D:()=>(h=f,f=0,[h,2===_||O()+l>=B()]),H(e,t){const r=[e,t];return x.add(r),()=>{x.delete(r)}},L(e,t){let r,n,m=0;switch(e){case 1:{const e=h;h=0;const r=t-a,o=b(r);e&&o<b(e)+1||0!==_||(g=r<0?2:1),s&&(p=v,s=!1),a=t,m=4;const i=O();i>=-l&&i<=B()&&(m+=1,n=o>l);break}case 2:m=8,0!==g&&(r=!0,m+=1),g=0,_=0,p=v;break;case 3:{const e=t.filter((([e,t])=>z.o[e]!==t));if(!e.length)break;L(e.reduce(((e,[t,r])=>((2===_||(p?t<p[0]:D(t)+(0===g&&0===_?E(t):0)<O()))&&(e+=r-E(t)),e)),0));for(const[t,r]of e){const e=E(t),n=T(z,t,r);o&&(y+=n?r:r-e)}o&&l&&y>l&&(L(((e,t)=>{let r=0;const n=e.o.filter(((e,n)=>{const o=e!==k;return o&&n<t&&r++,o})),o=e.i;return e.l=-1,((e.i=(e=>{const t=(e=>[...e].sort(((e,t)=>e-t)))(e),r=e.length/2|0;return t.length%2==0?(t[r-1]+t[r])/2:t[r]})(n))-o)*w(t-r,0)})(z,S[0])),o=!1),m=3,n=!0;break}case 4:l!==t&&(l=t,m=3);break;case 5:t[1]?(L(J(z,t[0],!0)),_=2,m=1):J(z,t[0]);break;case 6:c=t;break;case 7:_=1;break;case 8:p=P(t),m=1}m&&(i=[],r&&d&&(f+=d,d=0,u++),x.forEach((([e,t])=>{m&e&&t(n)})))}}},q=e=>{let t;return{W(r){(t||(t=new(D(B(r)).ResizeObserver)(e))).observe(r)},j(e){t.unobserve(e)},q(){t&&t.disconnect()}}},U=(e,t)=>t&&E()?-e:e,V=(e,t,r,n,o,s)=>{const i=Date.now;let l=0,c=!1,a=!1,u=!1,f=!1;const d=(()=>{let t;const r=()=>{t!=v&&clearTimeout(t)},n=()=>{r(),t=S((()=>{t=v,(()=>{if(c||a)return c=!1,void d();u=!1,e.L(2)})()}),150)};return n.U=r,n})(),h=()=>{l=i(),u&&(f=!0),s&&e.L(6,s()),e.L(1,n()),d()},g=t=>{if(c||0===e.C()||t.ctrlKey)return;const n=i()-l;150>n&&50<n&&(r?t.deltaX:t.deltaY)&&(c=!0)},_=()=>{a=!0,u=f=!1},p=()=>{a=!1,H()&&(u=!0)};return t.addEventListener("scroll",h),t.addEventListener("wheel",g,{passive:!0}),t.addEventListener("touchstart",_,{passive:!0}),t.addEventListener("touchend",p,{passive:!0}),{q:()=>{t.removeEventListener("scroll",h),t.removeEventListener("wheel",g),t.removeEventListener("touchstart",_),t.removeEventListener("touchend",p),d.U()},V:()=>{const[t,s]=e.D();t&&(o(U(t,r),s,f),f=!1,s&&e.J()>e.P()&&e.L(1,n()))}}},X=r=>{let n;r=c({X:"div"},r),a((()=>{n&&f(r.Y(n,r.F))}));const o=u((()=>{const e=r.A,t={margin:0,padding:0,position:"absolute",[e?"height":"width"]:"100%",[e?"top":"left"]:"0px",[e?E()?"right":"left":"top"]:r.G+"px",visibility:r.K?"hidden":"visible"};return e&&(t.display="flex"),t}));return e(t,{get component(){return r.X},ref(e){"function"==typeof n?n(e):n=e},get style(){return o()},get children(){return r.N}})},Y=e=>{let t=new Map;return f((()=>{for(const e of t.values())e.q()})),u((()=>{const r=e.Z,[n,o]=e.$,s=new Map,i=[];for(let l=n;l<=o;l++){const n=r[l],o=t.get(l);i.push(o?o.ee:d((t=>{const r=h(n),o=e.te(r[0],l);return s.set(l,{re:r,ee:o,q:t}),o}))),o&&(n!==o.re&&o.re[1](n),s.set(l,o))}for(const[e,r]of t.entries())s.has(e)||r.q();return t=s,i}))},F=(e,t)=>e[0]===t[0]&&e[1]===t[1],A=r=>{let n;const{itemSize:o,horizontal:s=!1}=r;r=c({as:"div"},r);const i=j(r.data.length,null!=o?o:40,void 0,0,!o),l=((e,t)=>{let r;const n=t?"width":"height",o=new WeakMap,s=q((t=>{const s=[];for(const{target:i,contentRect:l}of t)if(i.offsetParent)if(i===r)e.L(4,l[n]);else{const e=o.get(i);e!=v&&s.push([e,l[n]])}s.length&&e.L(3,s)}));return{ne(e){s.W(r=e)},oe:(e,t)=>(o.set(e,t),s.W(e),()=>{o.delete(e),s.j(e)}),q:s.q}})(i,s),d=((e,t)=>{let r,n,o;const s=t?"scrollLeft":"scrollTop",i=t?"overflowX":"overflowY",l=async(n,i)=>{if(!r)return void z((()=>l(n,i)));o&&o();const c=()=>{let t;return[new Promise(((r,n)=>{t=r,o=n,e.S()&&S(n,150)})),e.H(2,(()=>{t&&t()}))]};if(i&&L()){for(;e.L(8,n()),e.k();){const[e,t]=c();try{await e}catch(e){return}finally{t()}}r.scrollTo({[t?"left":"top"]:U(n(),t),behavior:"smooth"})}else for(;;){const[o,i]=c();try{r[s]=U(n(),t),e.L(7),await o}catch(e){return}finally{i()}}};return{W(l){r=l,n=V(e,l,t,(()=>U(l[s],t)),((t,r,n)=>{if(n){const e=l.style,t=e[i];e[i]="hidden",S((()=>{e[i]=t}))}r?(l[s]=e.R()+t,o&&o()):l[s]+=t}))},q(){n&&n.q()},se(e){l((()=>e))},ie(t){t+=e.R(),l((()=>t))},le(t,{align:r,smooth:n,offset:o=0}={}){if(t=y(t,0,e.T()-1),"nearest"===r){const n=e.I(t),o=e.R();if(n<o)r="start";else{if(!(n+e.M(t)>o+e.J()))return;r="end"}}l((()=>o+e.O()+e.I(t)+("end"===r?e.M(t)-e.J():"center"===r?(e.M(t)-e.J())/2:0)),n)},V:()=>{n&&n.V()}}})(i,s),[m,b]=h(i._()),x=i.H(1,(()=>{b(i._())})),k=i.H(4,(()=>{var e;null===(e=r.onScroll)||void 0===e||e.call(r,i.R())})),I=i.H(8,(()=>{var e;null===(e=r.onScrollEnd)||void 0===e||e.call(r)})),M=u((e=>{m();const t=i.v();return e&&F(e,t)?e:t})),T=u((()=>m()&&i.C())),R=u((()=>m()&&i.P())),C=u((()=>m()&&i.B())),J=u((e=>{var t;const n=null!==(t=r.overscan)&&void 0!==t?t:4,[o,s]=M(),i=W(o,s,n,T(),r.data.length);return e&&F(e,i)?e:i}));return g((()=>{r.ref&&r.ref({get scrollOffset(){return i.R()},get scrollSize(){return(e=>w(e.P(),e.J()))(i)},get viewportSize(){return i.J()},getItemOffset:i.I,scrollToIndex:d.le,scrollTo:d.se,scrollBy:d.ie});const e=r.scrollRef||n.parentElement;l.ne(e),d.W(e),f((()=>{r.ref&&r.ref(),x(),k(),I(),l.q(),d.q()}))})),_(p((()=>r.data.length),(e=>{e!==i.T()&&i.L(5,[e,r.shift])}))),_(p((()=>r.startMargin||0),(e=>{e!==i.O()&&i.L(6,e)}))),a(p(C,(()=>{d.V()}))),a((()=>{const e=M();r.onRangeChange&&r.onRangeChange(e[0],e[1])})),e(t,{get component(){return r.as},ref(e){"function"==typeof n?n(e):n=e},get style(){return{"overflow-anchor":"none",flex:"none",position:"relative",visibility:"hidden",width:s?R()+"px":"100%",height:s?"100%":R()+"px","pointer-events":0!==T()?"none":"auto"}},get children(){return e(Y,{get Z(){return r.data},get $(){return J()},te:(t,n)=>{const o=u((()=>(m(),i.I(n)))),c=u((()=>(m(),i.m(n))));return e(X,{get X(){return r.item},F:n,get Y(){return l.oe},get G(){return o()},get K(){return c()},get N(){return r.children(t(),n)},A:s})}})}})};var G=/*#__PURE__*/s("<div>");const K=t=>{const{ref:s,data:i,children:l,overscan:c,itemSize:a,shift:u,horizontal:f,onScroll:d,onScrollEnd:h,onRangeChange:g,style:_,...p}=t;return v=G(),r(v,n(p,{get style(){return{display:f?"inline-block":"block",[f?"overflow-x":"overflow-y"]:"auto",contain:"strict",width:"100%",height:"100%",...t.style}}}),!1,!0),o(v,e(A,{ref(e){var r=t.ref;"function"==typeof r?r(e):t.ref=e},get data(){return t.data},get overscan(){return t.overscan},get itemSize(){return t.itemSize},get shift(){return t.shift},horizontal:f,get onScroll(){return t.onScroll},get onScrollEnd(){return t.onScrollEnd},get onRangeChange(){return t.onRangeChange},get children(){return t.children}})),v;var v};var N=/*#__PURE__*/s("<div>");const Q=t=>{let r;const{data:n,children:s,overscan:c,itemSize:d,shift:m,horizontal:w=!1,onScrollEnd:b,onRangeChange:S}=t,z=j(t.data.length,null!=d?d:40,void 0,0,!d),x=((e,t)=>{const r=t?"width":"height",n=t?"innerWidth":"innerHeight",o=new WeakMap,s=q((t=>{const n=[];for(const{target:e,contentRect:s}of t){if(!e.offsetParent)continue;const t=o.get(e);t!=v&&n.push([t,s[r]])}n.length&&e.L(3,n)}));let i;return{ne(t){const r=D(B(t)),o=()=>{e.L(4,r[n])};r.addEventListener("resize",o),o(),i=()=>{r.removeEventListener("resize",o)}},oe:(e,t)=>(o.set(e,t),s.W(e),()=>{o.delete(e),s.j(e)}),q(){i&&i(),s.q()}}})(z,w),k=((e,t)=>{let r;return{W(n){const o=t?"scrollX":"scrollY",s=B(n),i=D(s),l=s.body,c=(e,t,r,n=0)=>{const o=r?"offsetLeft":"offsetTop",s=n+(r&&E()?i.innerWidth-e[o]-e.offsetWidth:e[o]),l=e.offsetParent;return e!==t&&l?c(l,t,r,s):s};r=V(e,i,t,(()=>U(i[o],t)),((r,n)=>{n?i.scroll({[t?"left":"top"]:e.R()+r}):i.scrollBy(t?r:0,t?0:r)}),(()=>c(n,l,t)))},q(){r&&r.q()},V:()=>{r&&r.V()},le:async(r,n={})=>{const o=n.align||"start",s=n.smooth,i=n.offset||0;r=y(r,0,e.T()-1);const l=e.I(r),c=e.J(),a=e.M(r);let u=l+i;if("end"===o)u+=a-c;else if("center"===o)u+=(a-c)/2;else if("nearest"===o){const t=e.R();if(l<t)u=l+i;else{if(!(l+a>t+c))return;u=l+a-c+i}}e.L(8,u);const f=U(u,t);s&&L()?window.scrollTo({[t?"left":"top"]:f,behavior:"smooth"}):window.scrollTo({[t?"left":"top"]:f}),await new Promise((e=>{window.requestAnimationFrame(e)})),e.L(7)}}})(z,w),[I,M]=h(z._()),T=z.H(1,(()=>{M(z._())})),R=z.H(8,(()=>{var e;null===(e=t.onScrollEnd)||void 0===e||e.call(t)})),C=u((e=>{I();const t=z.v();return e&&F(e,t)?e:t})),J=u((()=>I()&&z.C())),O=u((()=>I()&&z.P())),P=u((()=>I()&&z.B())),H=u((e=>{var r;const n=null!==(r=t.overscan)&&void 0!==r?r:4,[o,s]=C(),i=W(o,s,n,J(),t.data.length);return e&&F(e,i)?e:i}));return g((()=>{x.ne(r),k.W(r),f((()=>{T(),R(),x.q(),k.q()}))})),_(p((()=>t.data.length),(e=>{e!==z.T()&&z.L(5,[e,t.shift])}))),a(p(P,(()=>{k.V()}))),a((()=>{const e=C();t.onRangeChange&&t.onRangeChange(e[0],e[1])})),A=N(),"function"==typeof r?i(r,A):r=A,A.style.setProperty("overflow-anchor","none"),A.style.setProperty("flex","none"),A.style.setProperty("position","relative"),A.style.setProperty("visibility","hidden"),o(A,e(Y,{get Z(){return t.data},get $(){return H()},te:(r,n)=>{const o=u((()=>(I(),z.I(n)))),s=u((()=>(I(),z.m(n))));return e(X,{F:n,get Y(){return x.oe},get G(){return o()},get K(){return s()},get N(){return t.children(r(),n)},A:w})}})),l((e=>{var t=w?O()+"px":"100%",r=w?"100%":O()+"px",n=0!==J()?"none":"auto";return t!==e.e&&(null!=(e.e=t)?A.style.setProperty("width",t):A.style.removeProperty("width")),r!==e.t&&(null!=(e.t=r)?A.style.setProperty("height",r):A.style.removeProperty("height")),n!==e.a&&(null!=(e.a=n)?A.style.setProperty("pointer-events",n):A.style.removeProperty("pointer-events")),e}),{e:void 0,t:void 0,a:void 0}),A;var A};export{K as VList,A as Virtualizer,Q as WindowVirtualizer};
//# sourceMappingURL=index.mjs.map
