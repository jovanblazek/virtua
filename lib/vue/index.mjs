import{defineComponent as e,ref as t,watch as o,createVNode as r,isVNode as n,onMounted as s,onUnmounted as i}from"vue";const l=null,c=Math.min,a=Math.max,u=Math.abs,f=setTimeout,d=(e,t,o)=>c(o,a(t,e)),_="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},p=e=>{let t,o;return(...r)=>(t||(t=!0,o=e(...r)),o)},h=-1,g=(e,t,o)=>{const r=o?"unshift":"push";for(let o=0;o<t;o++)e[r](h);return e},m=(e,t)=>{const o=e.t[t];return o===h?e.o:o},v=(e,t,o)=>{const r=e.t[t]===h;return e.t[t]=o,e.i=c(t,e.i),r},b=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let o=e.i,r=e.u[o];for(;o<t;)r+=m(e,o),e.u[++o]=r;return e.i=t,r},y=(e,t,o)=>{for(;o>=0&&o<e.l;){const r=b(e,o);if(r<=t){if(r+m(e,o)>t)break;o++}else o--}return d(o,0,e.l-1)},S=(e,t,o)=>{const r=t-e.l;return e.i=o?-1:c(t-1,e.i),e.l=t,r>0?(g(e.u,r),g(e.t,r,o),e.o*r):(e.u.splice(r),(o?e.t.splice(0,-r):e.t.splice(r)).reduce(((t,o)=>t-(o===h?e.o:o)),0))},w="undefined"!=typeof window,z=()=>document.documentElement,x=e=>e.ownerDocument,k=e=>e.defaultView,I=/*#__PURE__*/p((()=>!!w&&"rtl"===getComputedStyle(z()).direction)),O=/*#__PURE__*/p((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),C=/*#__PURE__*/p((()=>"scrollBehavior"in z().style)),j=(e,t,o,r,n)=>(1!==r&&(e-=a(0,o)),2!==r&&(t+=a(0,o)),[a(e,0),c(t,n-1)]),B=(e,t=40,o=0,r,n=!1)=>{let s=!!o,i=[],f=0,d=0,_=0,p=0,w=0,z=0,x=0,k=0,I=0,C=s?[0,a(o-1,0)]:l,j=[0,0],B=0;const R=((e,t)=>({o:t,t:g([],e),l:e,i:-1,u:g([],e)}))(e,t),T=new Set,N=()=>_-d,q=e=>((e,t,o,r)=>{const n=y(e,t,c(o,e.l-1));return[n,y(e,t+r,n)]})(R,e,j[0],f),E=()=>(e=>e.l?b(e,e.l-1)+m(e,e.l-1):0)(R),M=e=>b(R,e)-z,H=e=>m(R,e),A=e=>{e&&(O()&&0!==k?z+=e:(w+=e,p++))};return{p:()=>i,h:()=>(e=>[[...e.t],e.o])(R),m:()=>x?j:(j=q(a(0,N()+z+w)),C?[c(j[0],C[0]),a(j[1],C[1])]:j),v:e=>R.t[e]===h,S:()=>!!f,k:()=>!!C&&R.t.slice(a(0,C[0]-1),c(R.l-1,C[1]+1)+1).includes(h),I:M,O:H,C:()=>R.l,j:()=>_,B:()=>k,R:()=>f,T:()=>d,N:E,q:()=>p,M:()=>(x=w,w=0,[x,2===I||N()+f>=E()]),H(e,t){const o=[e,t];return T.add(o),()=>{T.delete(o)}},A(e,t){let o,r,c=0;switch(e){case 1:{const e=x;x=0;const o=t-_,n=u(o);e&&n<u(e)+1||0!==I||(k=o<0?2:1),s&&(C=l,s=!1),_=t,c=4;const i=N();i>=-f&&i<=E()&&(c+=1,r=n>f);break}case 2:c=8,0!==k&&(o=!0,c+=1),k=0,I=0,C=l;break;case 3:{const e=t.filter((([e,t])=>R.t[e]!==t));if(!e.length)break;A(e.reduce(((e,[t,o])=>((2===I||(C?t<C[0]:M(t)+(0===k&&0===I?H(t):0)<N()))&&(e+=o-H(t)),e)),0));for(const[t,o]of e){const e=H(t),r=v(R,t,o);n&&(B+=r?o:o-e)}n&&f&&B>f&&(A(((e,t)=>{let o=0;const r=e.t.filter(((e,r)=>{const n=e!==h;return n&&r<t&&o++,n})),n=e.o;return e.i=-1,((e.o=(e=>{const t=(e=>[...e].sort(((e,t)=>e-t)))(e),o=e.length/2|0;return t.length%2==0?(t[o-1]+t[o])/2:t[o]})(r))-n)*a(t-o,0)})(R,j[0])),n=!1),c=3,r=!0;break}case 4:f!==t&&(f=t,c=3);break;case 5:t[1]?(A(S(R,t[0],!0)),I=2,c=1):S(R,t[0]);break;case 6:d=t;break;case 7:I=1;break;case 8:C=q(t),c=1}c&&(i=[],o&&z&&(w+=z,z=0,p++),T.forEach((([e,t])=>{c&e&&t(r)})))}}},R=e=>{let t;return{J(o){(t||(t=new(k(x(o)).ResizeObserver)(e))).observe(o)},P(e){t.unobserve(e)},D(){t&&t.disconnect()}}},T=(e,t)=>t&&I()?-e:e,N=(e,t,o,r,n,s)=>{const i=Date.now;let c=0,a=!1,u=!1,d=!1,_=!1;const p=(()=>{let t;const o=()=>{t!=l&&clearTimeout(t)},r=()=>{o(),t=f((()=>{t=l,(()=>{if(a||u)return a=!1,void p();d=!1,e.A(2)})()}),150)};return r.L=o,r})(),h=()=>{c=i(),d&&(_=!0),s&&e.A(6,s()),e.A(1,r()),p()},g=t=>{if(a||0===e.B()||t.ctrlKey)return;const r=i()-c;150>r&&50<r&&(o?t.deltaX:t.deltaY)&&(a=!0)},m=()=>{u=!0,d=_=!1},v=()=>{u=!1,O()&&(d=!0)};return t.addEventListener("scroll",h),t.addEventListener("wheel",g,{passive:!0}),t.addEventListener("touchstart",m,{passive:!0}),t.addEventListener("touchend",v,{passive:!0}),{D:()=>{t.removeEventListener("scroll",h),t.removeEventListener("wheel",g),t.removeEventListener("touchstart",m),t.removeEventListener("touchend",v),p.L()},W:()=>{const[t,s]=e.M();t&&(n(T(t,o),s,_),_=!1,s&&e.R()>e.N()&&e.A(1,r()))}}},q=/*#__PURE__*/e({props:{X:{type:Object,required:!0},Y:{type:Function,required:!0},F:{type:Number,required:!0},U:{type:Number,required:!0},V:{type:Boolean},G:{type:Boolean},K:{type:Boolean},Z:{type:String,required:!0}},setup(e){const s=t();return o((()=>s.value&&e.F),((t,o,r)=>{r(e.Y(s.value,e.F))}),{flush:"post"}),()=>{const{X:t,U:o,V:i,G:l,K:c,Z:a}=e,u={margin:0,padding:0,position:i&&c?void 0:"absolute",[l?"height":"width"]:"100%",[l?"top":"left"]:"0px",[l?I()?"right":"left":"top"]:o+"px",visibility:!i||c?"visible":"hidden"};return l&&(u.display="flex"),r(a,{ref:s,style:u},"function"==typeof(f=t)||"[object Object]"===Object.prototype.toString.call(f)&&!n(f)?t:{default:()=>[t],_:2},8,["style"]);var f}}}),E=(e,t)=>{const o=e.key;return o!=l?o:"_"+t},M=/*#__PURE__*/e({props:{data:{type:Array,required:!0},overscan:{type:Number,default:4},itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"}},emits:["scroll","scrollEnd","rangeChange"],setup(e,{emit:c,expose:u,slots:p}){var h;let g=!!e.ssrCount;const m=e.horizontal,v=t(),b=B(e.data.length,null!==(h=e.itemSize)&&void 0!==h?h:40,e.ssrCount,0,!e.itemSize),y=((e,t)=>{let o;const r=t?"width":"height",n=new WeakMap,s=R((t=>{const s=[];for(const{target:i,contentRect:c}of t)if(i.offsetParent)if(i===o)e.A(4,c[r]);else{const e=n.get(i);e!=l&&s.push([e,c[r]])}s.length&&e.A(3,s)}));return{$(e){s.J(o=e)},ee:(e,t)=>(n.set(e,t),s.J(e),()=>{n.delete(e),s.P(e)}),D:s.D}})(b,m),S=((e,t)=>{let o,r,n;const s=t?"scrollLeft":"scrollTop",i=t?"overflowX":"overflowY",l=async(r,i)=>{if(!o)return void _((()=>l(r,i)));n&&n();const c=()=>{let t;return[new Promise(((o,r)=>{t=o,n=r,e.S()&&f(r,150)})),e.H(2,(()=>{t&&t()}))]};if(i&&C()){for(;e.A(8,r()),e.k();){const[e,t]=c();try{await e}catch(e){return}finally{t()}}o.scrollTo({[t?"left":"top"]:T(r(),t),behavior:"smooth"})}else for(;;){const[n,i]=c();try{o[s]=T(r(),t),e.A(7),await n}catch(e){return}finally{i()}}};return{J(l){o=l,r=N(e,l,t,(()=>T(l[s],t)),((t,o,r)=>{if(r){const e=l.style,t=e[i];e[i]="hidden",f((()=>{e[i]=t}))}o?(l[s]=e.j()+t,n&&n()):l[s]+=t}))},D(){r&&r.D()},te(e){l((()=>e))},oe(t){t+=e.j(),l((()=>t))},re(t,{align:o,smooth:r,offset:n=0}={}){if(t=d(t,0,e.C()-1),"nearest"===o){const r=e.I(t),n=e.j();if(r<n)o="start";else{if(!(r+e.O(t)>n+e.R()))return;o="end"}}l((()=>n+e.T()+e.I(t)+("end"===o?e.O(t)-e.R():"center"===o?(e.O(t)-e.R())/2:0)),r)},W:()=>{r&&r.W()}}})(b,m),w=t(b.p()),z=b.H(1,(()=>{w.value=b.p()})),x=b.H(4,(()=>{c("scroll",b.j())})),k=b.H(8,(()=>{c("scrollEnd")}));return s((()=>{g=!1,_((()=>{const t=e=>{y.$(e),S.J(e)};e.scrollRef?t(e.scrollRef):t(v.value.parentElement)}))})),i((()=>{z(),x(),k(),y.D(),S.D()})),o((()=>e.data.length),(t=>{b.A(5,[t,e.shift])})),o((()=>e.startMargin),(e=>{b.A(6,e)}),{immediate:!0}),o([w,b.q],(([,e],[,t])=>{e!==t&&S.W()}),{flush:"post"}),o([w,b.m],(([,[e,t]],[,[o,r]])=>{o===e&&r===t||c("rangeChange",e,t)}),{flush:"post"}),u({get scrollOffset(){return b.j()},get scrollSize(){return(e=>a(e.N(),e.R()))(b)},get viewportSize(){return b.R()},getItemOffset:b.I,scrollToIndex:S.re,scrollTo:S.te,scrollBy:S.oe}),()=>{w.value;const t=e.as,o=e.item,s=e.data.length,[i,l]=b.m(),c=b.B(),a=b.N(),u=[];for(let[t,n]=j(i,l,e.overscan,c,s);t<=n;t++){const n=p.default(e.data[t])[0];u.push(r(q,{key:E(n,t),Y:y.ee,F:t,U:b.I(t),V:b.v(t),X:n,G:m,K:g,Z:o},null,8,["Y","F","U","V","X","G","K","Z"]))}return r(t,{ref:v,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:m?a+"px":"100%",height:m?"100%":a+"px",pointerEvents:0!==c?"none":"auto"}},"function"==typeof(f=u)||"[object Object]"===Object.prototype.toString.call(f)&&!n(f)?u:{default:()=>[u],_:2},8,["style"]);var f}}}),H=/*#__PURE__*/e({props:{data:{type:Array,required:!0},overscan:{type:Number,default:4},itemSize:Number,shift:Boolean,horizontal:Boolean,ssrCount:Number},emits:["scroll","scrollEnd","rangeChange"],setup(e,{emit:o,expose:s,slots:i}){const l=e.horizontal,c=e=>{o("scroll",e)},a=()=>{o("scrollEnd")},u=(e,t)=>{o("rangeChange",e,t)},f=t();return s({get scrollOffset(){return f.value.scrollOffset},get scrollSize(){return f.value.scrollSize},get viewportSize(){return f.value.viewportSize},getItemOffset:(...e)=>f.value.getItemOffset(...e),scrollToIndex:(...e)=>f.value.scrollToIndex(...e),scrollTo:(...e)=>f.value.scrollTo(...e),scrollBy:(...e)=>f.value.scrollBy(...e)}),()=>{return r("div",{style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%"}},[r(M,{ref:f,data:e.data,overscan:e.overscan,itemSize:e.itemSize,shift:e.shift,ssrCount:e.ssrCount,horizontal:l,onScroll:c,onScrollEnd:a,onRangeChange:u},(t=i,"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!n(t)?i:{default:()=>[i],_:2}),8,["data","overscan","itemSize","shift","ssrCount","horizontal","onScroll","onScrollEnd","onRangeChange"])],4);var t}}}),A=/*#__PURE__*/e({props:{data:{type:Array,required:!0},overscan:{type:Number,default:4},itemSize:Number,shift:Boolean,horizontal:Boolean,as:{type:String,default:"div"},item:{type:String,default:"div"}},emits:["scrollEnd","rangeChange"],setup(e,{emit:c,slots:a}){var u;const f=e.horizontal,_=t(),p=B(e.data.length,null!==(u=e.itemSize)&&void 0!==u?u:40,void 0,0,!e.itemSize),h=((e,t)=>{const o=t?"width":"height",r=t?"innerWidth":"innerHeight",n=new WeakMap,s=R((t=>{const r=[];for(const{target:e,contentRect:s}of t){if(!e.offsetParent)continue;const t=n.get(e);t!=l&&r.push([t,s[o]])}r.length&&e.A(3,r)}));let i;return{$(t){const o=k(x(t)),n=()=>{e.A(4,o[r])};o.addEventListener("resize",n),n(),i=()=>{o.removeEventListener("resize",n)}},ee:(e,t)=>(n.set(e,t),s.J(e),()=>{n.delete(e),s.P(e)}),D(){i&&i(),s.D()}}})(p,f),g=((e,t)=>{let o;return{J(r){const n=t?"scrollX":"scrollY",s=x(r),i=k(s),l=s.body,c=(e,t,o,r=0)=>{const n=o?"offsetLeft":"offsetTop",s=r+(o&&I()?i.innerWidth-e[n]-e.offsetWidth:e[n]),l=e.offsetParent;return e!==t&&l?c(l,t,o,s):s};o=N(e,i,t,(()=>T(i[n],t)),((o,r)=>{r?i.scroll({[t?"left":"top"]:e.j()+o}):i.scrollBy(t?o:0,t?0:o)}),(()=>c(r,l,t)))},D(){o&&o.D()},W:()=>{o&&o.W()},re:async(o,r={})=>{const n=r.align||"start",s=r.smooth,i=r.offset||0;o=d(o,0,e.C()-1);const l=e.I(o),c=e.R(),a=e.O(o);let u=l+i;if("end"===n)u+=a-c;else if("center"===n)u+=(a-c)/2;else if("nearest"===n){const t=e.j();if(l<t)u=l+i;else{if(!(l+a>t+c))return;u=l+a-c+i}}e.A(8,u);const f=T(u,t);s&&C()?window.scrollTo({[t?"left":"top"]:f,behavior:"smooth"}):window.scrollTo({[t?"left":"top"]:f}),await new Promise((e=>{window.requestAnimationFrame(e)})),e.A(7)}}})(p,f),m=t(p.p()),v=p.H(1,(()=>{m.value=p.p()})),b=p.H(8,(()=>{c("scrollEnd")}));return s((()=>{const e=_.value;e&&(h.$(e),g.J(e))})),i((()=>{v(),b(),h.D(),g.D()})),o((()=>e.data.length),(t=>{p.A(5,[t,e.shift])})),o([m,p.q],(([,e],[,t])=>{e!==t&&g.W()}),{flush:"post"}),o([m,p.m],(([,[e,t]],[,[o,r]])=>{o===e&&r===t||c("rangeChange",e,t)}),{flush:"post"}),()=>{m.value;const t=e.as,o=e.item,s=e.data.length,[i,l]=p.m(),c=p.B(),u=p.N(),d=[];for(let[t,n]=j(i,l,e.overscan,c,s);t<=n;t++){const n=a.default(e.data[t])[0];d.push(r(q,{key:E(n,t),Y:h.ee,F:t,U:p.I(t),V:p.v(t),X:n,G:f,Z:o},null,8,["Y","F","U","V","X","G","Z"]))}return r(t,{ref:_,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:f?u+"px":"100%",height:f?"100%":u+"px",pointerEvents:0!==c?"none":"auto"}},"function"==typeof(g=d)||"[object Object]"===Object.prototype.toString.call(g)&&!n(g)?d:{default:()=>[d],_:2},8,["style"]);var g}}});export{H as VList,M as Virtualizer,A as WindowVirtualizer};
//# sourceMappingURL=index.mjs.map
